<!DOCTYPE html>
<html>
<head lang="ja">
  <meta charset="UTF-8">
  <title>Todo List</title>
  <link rel="stylesheet" href="lib/base.css">
</head>
<body>
<div id="container"></div>
<div id="message"></div>

<script src="https://www.gstatic.com/firebasejs/3.7.2/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyBZURdCIXSIYzN-fu5chDE-zc6_C-C9FD0",
    authDomain: "reacttest-48bff.firebaseapp.com",
    databaseURL: "https://reacttest-48bff.firebaseio.com",
    storageBucket: "reacttest-48bff.appspot.com",
    messagingSenderId: "1007491313324"
  };
  firebase.initializeApp(config);

  /* Firebase User Login or Logout
  ------------------------------*/
  firebase.auth().onAuthStateChanged(function(user) {
    var message = document.getElementById('message');
    if (user) {
      // User is signed in.
      message.innerHTML = 'こんにちは、' + user.displayName + ' さん';
    } else {
      // No user is signed in.
      message.innerHTML = 'ログインしてください';
      login();
    }
  });

  function login() {
    var provider = new firebase.auth.GoogleAuthProvider();
    firebase.auth().signInWithRedirect(provider).then(function(result) {
      /* ----- MEMO -----------------------------------
         リダイレクトではなく、ポップアップで表示させたい場合は、
         signInWithRedirect を signInWithPopup に書き換える
       -------------------------------------------------- */

      // This gives you a Google Access Token. You can use it to access the Google API.
      var token = result.credential.accessToken;
      // The signed-in user info.
      var user = result.user;
      // ...
    }).catch(function(error) {
      // Handle Errors here.
      var errorCode = error.code;
      var errorMessage = error.message;
      // The email of the user's account used.
      var email = error.email;
      // The firebase.auth.AuthCredential type that was used.
      var credential = error.credential;
      // ...
    });
  }

  function logout() {
    firebase.auth().signOut().then(function() {
      // Sign-out successful.
    }, function(error) {
      // An error happened.
    });
  }
</script>
<script src="lib/app.js"></script>
</body>
</html>
